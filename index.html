<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./image/pokeball.png" type="image/png">
    <title>Who's That Pokémon?</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Who's That Pokémon?</h1>
    <div class="game-container">
        <img id="pokemon-image" class="pokemon-image" src="" alt="Hidden Pokémon">
        <div id="choices-container" class="choices-container"></div>
        <button id="next-button" class="next-btn" onclick="fetchPokemon()">Next Pokémon</button>
    </div>

    <script>
        let currentPokemon = {};
        const pokeApiUrl = 'https://pokeapi.co/api/v2/pokemon/';

        async function fetchPokemon() {
            resetGame();

            const randomId = Math.floor(Math.random() * 898) + 1;
            const correctPokemon = await getPokemonData(randomId);
            currentPokemon = correctPokemon;

            // Fetch 3 incorrect Pokémon for multiple-choice options
            const choices = [correctPokemon];
            while (choices.length < 4) {
                const randomId = Math.floor(Math.random() * 898) + 1;
                const pokemon = await getPokemonData(randomId);

                if (!choices.some(p => p.name === pokemon.name)) {
                    choices.push(pokemon);
                }
            }

            // Shuffle the choices array
            shuffleArray(choices);

            // Display the Pokémon silhouette and options
            document.getElementById('pokemon-image').src = correctPokemon.image;
            document.getElementById('pokemon-image').style.filter = 'brightness(0)';
            const choicesContainer = document.getElementById('choices-container');
            choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.name;
                button.onclick = () => checkAnswer(choice.name);
                choicesContainer.appendChild(button);
            });
        }

        async function getPokemonData(id) {
            const response = await fetch(`${pokeApiUrl}${id}`);
            const data = await response.json();
            return {
                name: data.name,
                image: data.sprites.front_default
            };
        }

        function checkAnswer(selectedName) {
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(button => {
                button.disabled = true; // Disable all buttons after selection
                if (button.textContent === currentPokemon.name) {
                    button.classList.add('correct'); // Highlight correct choice
                } else if (button.textContent === selectedName) {
                    button.classList.add('incorrect'); // Highlight incorrect choice
                }
            });
            document.getElementById('pokemon-image').style.filter = 'brightness(1)';
            document.getElementById('next-button').style.display = 'inline-block'; // Show Next button
        }

        function resetGame() {
            const choicesContainer = document.getElementById('choices-container');
            choicesContainer.innerHTML = ''; // Clear previous options
            document.getElementById('next-button').style.display = 'none'; // Hide Next button
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Load the first Pokémon on page load
        window.onload = fetchPokemon;
    </script>
</body>
</html>
